<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubernetsï¼ˆK8Sï¼‰ ä½¿ç”¨ | Linux_All_in_one</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/Linux_All_in_one/favicon.ico">
    <meta name="description" content="Linux è¿ç»´ã€è½¯ä»¶è¿ç»´ã€Docker æ•™ç¨‹ã€ç½‘ç»œå®‰å…¨">
    
    <link rel="preload" href="/Linux_All_in_one/assets/css/0.styles.407428ab.css" as="style"><link rel="preload" href="/Linux_All_in_one/assets/js/app.4a61619a.js" as="script"><link rel="preload" href="/Linux_All_in_one/assets/js/2.ee3c5eb7.js" as="script"><link rel="preload" href="/Linux_All_in_one/assets/js/1.bc260717.js" as="script"><link rel="preload" href="/Linux_All_in_one/assets/js/36.da0b8594.js" as="script"><link rel="preload" href="/Linux_All_in_one/assets/js/21.f8578145.js" as="script"><link rel="prefetch" href="/Linux_All_in_one/assets/js/100.5e0212b4.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/101.280ba6c4.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/102.fcbe69ef.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/103.59b3bf86.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/104.628bb6be.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/105.f6a0a62b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/106.53648c35.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/107.093c4fab.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/108.f8895b2f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/109.878b5e6d.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/110.e7dbd5ce.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/12.4bdd7f50.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/13.4850c8c8.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/14.66e24ed5.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/15.41d57e79.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/16.96600c16.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/17.1cd68a21.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/18.f54ebd77.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/19.36d25975.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/20.0120ca8c.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/22.9efa850b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/23.d7f5441c.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/24.1cabd94c.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/25.2cb5712a.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/26.440ab754.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/27.94e60af2.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/28.f1611369.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/29.730dead3.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/3.accc0318.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/30.f69c3378.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/31.be2478fc.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/32.9465ce70.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/33.f4c85e8a.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/34.c3a0ece1.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/35.a75dd538.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/37.c49eb234.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/38.16f7d0e5.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/39.ba6e47f0.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/4.9736648b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/40.664ddb58.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/41.4189f6ca.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/42.6472b832.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/43.c8d06688.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/44.e39a047e.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/45.39945860.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/46.ccbd9cdc.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/47.9bed3a75.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/48.05ecd397.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/49.4f2f2874.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/5.9a4eb5c9.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/50.d01632db.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/51.ad40e5f5.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/52.bfacfa08.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/53.9398692c.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/54.b34cb199.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/55.6735c148.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/56.575312d7.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/57.d54f0ac7.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/58.f3cc4cf5.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/59.881dba8f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/6.a3475002.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/60.859faf8a.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/61.4efca474.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/62.578a9742.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/63.95e6ff4f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/64.054ab297.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/65.5be33d9b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/66.2312529e.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/67.81dd084d.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/68.a11966f3.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/69.ffbf7d57.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/7.b4d90be9.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/70.51883659.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/71.9ff55cae.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/72.d54e184f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/73.5062fbf7.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/74.0721cccd.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/75.42dd3581.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/76.d590fa57.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/77.0e5953f3.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/78.4bb79720.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/79.48030292.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/80.d036bc22.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/81.d6524746.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/82.93460687.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/83.7c6f2e4a.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/84.83b1808d.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/85.14c12ffc.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/86.893b5c41.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/87.7d10879f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/88.ef12068f.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/89.cc81e4e4.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/90.130454fc.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/91.838da398.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/92.22813cd9.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/93.2000427b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/94.062717c8.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/95.9cc81974.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/96.0457546b.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/97.71d6bbd5.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/98.e6299973.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/99.b198a395.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/vendors~docsearch.00f0a528.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/vendors~flowchart.d07b8b19.js"><link rel="prefetch" href="/Linux_All_in_one/assets/js/vendors~notification.877bb3fc.js">
    <link rel="stylesheet" href="/Linux_All_in_one/assets/css/0.styles.407428ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Linux_All_in_one/" class="home-link router-link-active"><img src="/Linux_All_in_one/images/dunwu-logo-100.png" alt="Linux_All_in_one" class="logo"> <span class="site-name can-hide">Linux_All_in_one</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Linux_All_in_one/linux/cli/" class="nav-link">
  ğŸ’» Linux å‘½ä»¤
</a></div><div class="nav-item"><a href="/Linux_All_in_one/linux/ops/" class="nav-link">
  âš™ï¸ Linux è¿ç»´
</a></div><div class="nav-item"><a href="/Linux_All_in_one/linux/soft/" class="nav-link">
  ğŸ“¦ Linux è½¯ä»¶è¿ç»´
</a></div><div class="nav-item"><a href="/Linux_All_in_one/docker/" class="nav-link router-link-active">
  ğŸ³ Docker æ•™ç¨‹
</a></div><div class="nav-item"><a href="/Linux_All_in_one/Cybersecurity/" class="nav-link">
  ğŸ”’ Linuxä¸ç½‘ç»œå®‰å…¨
</a></div> <a href="https://github.com/adminlove520/Linux_All_in_one" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Linux_All_in_one/linux/cli/" class="nav-link">
  ğŸ’» Linux å‘½ä»¤
</a></div><div class="nav-item"><a href="/Linux_All_in_one/linux/ops/" class="nav-link">
  âš™ï¸ Linux è¿ç»´
</a></div><div class="nav-item"><a href="/Linux_All_in_one/linux/soft/" class="nav-link">
  ğŸ“¦ Linux è½¯ä»¶è¿ç»´
</a></div><div class="nav-item"><a href="/Linux_All_in_one/docker/" class="nav-link router-link-active">
  ğŸ³ Docker æ•™ç¨‹
</a></div><div class="nav-item"><a href="/Linux_All_in_one/Cybersecurity/" class="nav-link">
  ğŸ”’ Linuxä¸ç½‘ç»œå®‰å…¨
</a></div> <a href="https://github.com/adminlove520/Linux_All_in_one" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Kubernetsï¼ˆK8Sï¼‰ ä½¿ç”¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux_All_in_one/docker/K8S-Install-And-Usage.html#ç¯å¢ƒè¯´æ˜" class="sidebar-link">ç¯å¢ƒè¯´æ˜</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Linux_All_in_one/docker/K8S-Install-And-Usage.html#kubernetes" class="sidebar-link">Kubernetes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/Linux_All_in_one/docker/K8S-Install-And-Usage.html#èµ„æ–™" class="sidebar-link">èµ„æ–™</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="kubernets-k8s-ä½¿ç”¨"><a href="#kubernets-k8s-ä½¿ç”¨" class="header-anchor">#</a> Kubernetsï¼ˆK8Sï¼‰ ä½¿ç”¨</h1> <h2 id="ç¯å¢ƒè¯´æ˜"><a href="#ç¯å¢ƒè¯´æ˜" class="header-anchor">#</a> ç¯å¢ƒè¯´æ˜</h2> <ul><li>CentOS 7.5ï¼ˆä¸å‡†ç¡®åœ°è¯´ï¼šè¦æ±‚å¿…é¡»æ˜¯ CentOS 7 64ä½ï¼‰</li> <li>Docker</li></ul> <h2 id="kubernetes"><a href="#kubernetes" class="header-anchor">#</a> Kubernetes</h2> <ul><li>ç›®å‰æµè¡Œçš„å®¹å™¨ç¼–æ’ç³»ç»Ÿ</li> <li>ç®€ç§°ï¼šK8S</li> <li>å®˜ç½‘ï¼š<a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ä¸»è¦è§£å†³å‡ ä¸ªé—®é¢˜ï¼š
<ul><li><code>è°ƒåº¦</code></li> <li><code>ç”Ÿå‘½å‘¨æœŸåŠå¥åº·çŠ¶å†µ</code></li> <li><code>æœåŠ¡å‘ç°</code></li> <li><code>ç›‘æ§</code></li> <li><code>è®¤è¯</code></li> <li><code>å®¹å™¨èšåˆ</code></li></ul></li> <li>ä¸»è¦è§’è‰²ï¼šMasterã€Node</li></ul> <h4 id="å®‰è£…å‡†å¤‡-kubernetes-1-13-ç‰ˆæœ¬"><a href="#å®‰è£…å‡†å¤‡-kubernetes-1-13-ç‰ˆæœ¬" class="header-anchor">#</a> å®‰è£…å‡†å¤‡ - Kubernetes 1.13 ç‰ˆæœ¬</h4> <ul><li>æ¨èæœ€ä½ 2C2Gï¼Œä¼˜å…ˆï¼š2C4G æˆ–ä»¥ä¸Š</li> <li>ç‰¹åˆ«è¯´æ˜ï¼š1.13 ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œç”±äºç½‘ç»œé—®é¢˜ï¼Œéœ€è¦å„ç§è®¾ç½®ï¼Œè¿™é‡Œå°±ä¸å†å¤šè¯´äº†ã€‚1.13 ä¹‹åç›¸å¯¹å°±ç®€å•äº†ç‚¹ã€‚</li> <li>ä¼˜å…ˆå®˜ç½‘è½¯ä»¶åŒ…ï¼škubeadm</li> <li>å®˜ç½‘èµ„æ–™ï¼š
<ul><li>issues å…¥å£ï¼š<a href="https://github.com/kubernetes/kubeadm" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubeadm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>æºç å…¥å£ï¼š<a href="https://github.com/kubernetes/kubernetes/tree/master/cmd/kubeadm" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/tree/master/cmd/kubeadm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>å®‰è£…æŒ‡å¯¼ï¼š<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/independent/install-kubeadm/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>æŒ‰å®˜ç½‘è¦æ±‚åšä¸‹æ£€æŸ¥ï¼š<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/#before-you-begin" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/independent/install-kubeadm/#before-you-begin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ç½‘ç»œç¯å¢ƒï¼š<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/#verify-the-mac-address-and-product-uuid-are-unique-for-every-node" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/independent/install-kubeadm/#verify-the-mac-address-and-product-uuid-are-unique-for-every-node<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ç«¯å£æ£€æŸ¥ï¼š<a href="https://kubernetes.io/docs/setup/independent/install-kubeadm/#check-required-ports" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/independent/install-kubeadm/#check-required-ports<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>å¯¹ Docker ç‰ˆæœ¬çš„æ”¯æŒï¼Œè¿™é‡Œå®˜ç½‘æ¨èçš„æ˜¯ 18.06</strong>ï¼š<a href="https://kubernetes.io/docs/setup/release/notes/#sig-cluster-lifecycle" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/release/notes/#sig-cluster-lifecycle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>ä¸‰å¤§æ ¸å¿ƒå·¥å…·åŒ…ï¼Œéƒ½éœ€è¦å„è‡ªå®‰è£…ï¼Œå¹¶ä¸”æ³¨æ„ç‰ˆæœ¬å…³ç³»ï¼š
<ul><li><code>kubeadm</code>: the command to bootstrap the cluster.
<ul><li>é›†ç¾¤éƒ¨ç½²ã€ç®¡ç†å·¥å…·</li></ul></li> <li><code>kubelet</code>: the component that runs on all of the machines in your cluster and does things like starting pods and containers.
<ul><li>å…·ä½“æ‰§è¡Œå±‚é¢çš„ç®¡ç† Pod å’Œ Docker å·¥å…·</li></ul></li> <li><code>kubectl</code>: the command line util to talk to your cluster.
<ul><li>æ“ä½œ k8s çš„å‘½ä»¤è¡Œå…¥å£å·¥å…·</li></ul></li></ul></li> <li>å®˜ç½‘æ’ä»¶å®‰è£…è¿‡ç¨‹çš„æ•…éšœæ’æŸ¥ï¼š<a href="https://kubernetes.io/docs/setup/independent/troubleshooting-kubeadm/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/setup/independent/troubleshooting-kubeadm/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>å…¶ä»–éƒ¨ç½²æ–¹æ¡ˆï¼š
<ul><li><a href="https://github.com/coreos/tectonic-installer" target="_blank" rel="noopener noreferrer">https://github.com/coreos/tectonic-installer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/kubernetes-incubator/kubespray" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes-incubator/kubespray<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/apprenda/kismatic" target="_blank" rel="noopener noreferrer">https://github.com/apprenda/kismatic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <h4 id="å¼€å§‹å®‰è£…-kubernetes-1-13-3-ç‰ˆæœ¬"><a href="#å¼€å§‹å®‰è£…-kubernetes-1-13-3-ç‰ˆæœ¬" class="header-anchor">#</a> å¼€å§‹å®‰è£… - Kubernetes 1.13.3 ç‰ˆæœ¬</h4> <ul><li>ä¸‰å°æœºå­ï¼š
<ul><li>master-1ï¼š<code>192.168.0.127</code></li> <li>node-1ï¼š<code>192.168.0.128</code></li> <li>node-2ï¼š<code>192.168.0.129</code></li></ul></li> <li>å®˜ç½‘æœ€æ–°ç‰ˆæœ¬ï¼š<a href="https://github.com/kubernetes/kubernetes/releases" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/releases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>å®˜ç½‘ 1.13 ç‰ˆæœ¬çš„ changelogï¼š<a href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.13.md" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.13.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>æ‰€æœ‰èŠ‚ç‚¹å®‰è£… Docker 18.06ï¼Œå¹¶è®¾ç½®é˜¿é‡Œäº‘æº</strong> <ul><li>å¯ä»¥å‚è€ƒï¼š<a href="https://github.com/judasn/Linux-Tutorial/blob/master/favorite-file/shell/install_docker_k8s_disable_firewalld_centos7-aliyun.sh" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æˆ‘o(âˆ©_âˆ©)o <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>æ ¸å¿ƒï¼ŒæŸ¥çœ‹å¯ä»¥å®‰è£…çš„ Docker åˆ—è¡¨ï¼š<code>yum list docker-ce --showduplicates</code></li></ul></li> <li>æ‰€æœ‰èŠ‚ç‚¹è®¾ç½® kubernetes repo æºï¼Œå¹¶å®‰è£… Kubeadmã€Kubeletã€Kubectl éƒ½è®¾ç½®é˜¿é‡Œäº‘çš„æº</li> <li>Kubeadm åˆå§‹åŒ–é›†ç¾¤è¿‡ç¨‹å½“ä¸­ï¼Œå®ƒä¼šä¸‹è½½å¾ˆå¤šçš„é•œåƒï¼Œé»˜è®¤ä¹Ÿæ˜¯å» Google å®¶é‡Œä¸‹è½½ã€‚ä½†æ˜¯ 1.13 æ–°å¢äº†ä¸€ä¸ªé…ç½®ï¼š<code>--image-repository</code> ç®—æ˜¯æ•‘äº†å‘½ã€‚</li></ul> <h4 id="å®‰è£…å…·ä½“æµç¨‹"><a href="#å®‰è£…å…·ä½“æµç¨‹" class="header-anchor">#</a> å®‰è£…å…·ä½“æµç¨‹</h4> <ul><li>åŒæ­¥æ‰€æœ‰æœºå­æ—¶é—´ï¼š<code>systemctl start chronyd.service &amp;&amp; systemctl enable chronyd.service</code></li> <li>æ‰€æœ‰æœºå­ç¦ç”¨é˜²ç«å¢™ã€selinuxã€swap</li></ul> <div class="language- extra-class"><pre class="language-text"><code>systemctl stop firewalld.service
systemctl disable firewalld.service
systemctl disable iptables.service

iptables -P FORWARD ACCEPT

setenforce 0 &amp;&amp; sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config

echo &quot;vm.swappiness = 0&quot; &gt;&gt; /etc/sysctl.conf
swapoff -a &amp;&amp; sysctl -w vm.swappiness=0
</code></pre></div><ul><li>ç»™å„è‡ªæœºå­è®¾ç½® hostname å’Œ hosts</li></ul> <div class="language- extra-class"><pre class="language-text"><code>hostnamectl --static set-hostname  k8s-master-1
hostnamectl --static set-hostname  k8s-node-1
hostnamectl --static set-hostname  k8s-node-2


vim /etc/hosts
192.168.0.127 k8s-master-1
192.168.0.128 k8s-node-1
192.168.0.129 k8s-node-2
</code></pre></div><ul><li>ç»™ master è®¾ç½®å…å¯†</li></ul> <div class="language- extra-class"><pre class="language-text"><code>ssh-keygen -t rsa

cat /root/.ssh/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys


ssh localhost

ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@k8s-node-1ï¼ˆæ ¹æ®æç¤ºè¾“å…¥ k8s-node-1 å¯†ç ï¼‰
ssh-copy-id -i ~/.ssh/id_rsa.pub -p 22 root@k8s-node-2ï¼ˆæ ¹æ®æç¤ºè¾“å…¥ k8s-node-2 å¯†ç ï¼‰

ssh k8s-master-1
ssh k8s-node-1
ssh k8s-node-2
</code></pre></div><ul><li>ç»™æ‰€æœ‰æœºå­è®¾ç½® yum æº</li></ul> <div class="language- extra-class"><pre class="language-text"><code>vim /etc/yum.repos.d/kubernetes.repo

[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg


scp -r /etc/yum.repos.d/kubernetes.repo root@k8s-node-1:/etc/yum.repos.d/
scp -r /etc/yum.repos.d/kubernetes.repo root@k8s-node-2:/etc/yum.repos.d/
</code></pre></div><ul><li>ç»™ master æœºå­åˆ›å»º flannel é…ç½®æ–‡ä»¶</li></ul> <div class="language- extra-class"><pre class="language-text"><code>mkdir -p /etc/cni/net.d &amp;&amp; vim /etc/cni/net.d/10-flannel.conflist

{
    &quot;name&quot;: &quot;cbr0&quot;,
    &quot;plugins&quot;: [
        {
            &quot;type&quot;: &quot;flannel&quot;,
            &quot;delegate&quot;: {
                &quot;hairpinMode&quot;: true,
                &quot;isDefaultGateway&quot;: true
            }
        },
        {
            &quot;type&quot;: &quot;portmap&quot;,
            &quot;capabilities&quot;: {
                &quot;portMappings&quot;: true
            }
        }
    ]
}
</code></pre></div><ul><li>ç»™æ‰€æœ‰æœºå­åˆ›å»ºé…ç½®</li></ul> <div class="language- extra-class"><pre class="language-text"><code>vim /etc/sysctl.d/k8s.conf

net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
net.ipv4.ip_forward=1
vm.swappiness=0


scp -r /etc/sysctl.d/k8s.conf root@k8s-node-1:/etc/sysctl.d/
scp -r /etc/sysctl.d/k8s.conf root@k8s-node-2:/etc/sysctl.d/

modprobe br_netfilter &amp;&amp; sysctl -p /etc/sysctl.d/k8s.conf
</code></pre></div><ul><li>ç»™æ‰€æœ‰æœºå­å®‰è£…ç»„ä»¶</li></ul> <div class="language- extra-class"><pre class="language-text"><code>yum install -y kubelet-1.13.3 kubeadm-1.13.3 kubectl-1.13.3 --disableexcludes=kubernetes
</code></pre></div><ul><li>ç»™æ‰€æœ‰æœºå­æ·»åŠ ä¸€ä¸ªå˜é‡</li></ul> <div class="language- extra-class"><pre class="language-text"><code>vim  /etc/systemd/system/kubelet.service.d/10-kubeadm.conf

æœ€åä¸€è¡Œæ·»åŠ ï¼šEnvironment=&quot;KUBELET_CGROUP_ARGS=--cgroup-driver=cgroupfs&quot;
</code></pre></div><ul><li>å¯åŠ¨æ‰€æœ‰æœºå­</li></ul> <div class="language- extra-class"><pre class="language-text"><code>systemctl enable kubelet &amp;&amp; systemctl start kubelet

kubeadm version
kubectl version

</code></pre></div><ul><li>åˆå§‹åŒ– master èŠ‚ç‚¹ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward


kubeadm init \
--image-repository registry.cn-hangzhou.aliyuncs.com/google_containers \
--pod-network-cidr 10.244.0.0/16 \
--kubernetes-version 1.13.3 \
--ignore-preflight-errors=Swap

å…¶ä¸­ 10.244.0.0/16 æ˜¯ flannel æ’ä»¶å›ºå®šä½¿ç”¨çš„ipæ®µï¼Œå®ƒçš„å€¼å–å†³äºä½ å‡†å¤‡å®‰è£…å“ªä¸ªç½‘ç»œæ’ä»¶

è¿™ä¸ªè¿‡ç¨‹ä¼šä¸‹è½½ä¸€äº› docker é•œåƒï¼Œæ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒä¹…ï¼Œçœ‹ä½ ç½‘ç»œæƒ…å†µã€‚
ç»ˆç«¯ä¼šè¾“å‡ºæ ¸å¿ƒå†…å®¹ï¼š
[init] Using Kubernetes version: v1.13.3
[preflight] Running pre-flight checks
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Activating the kubelet service
[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;
[certs] Generating &quot;front-proxy-ca&quot; certificate and key
[certs] Generating &quot;front-proxy-client&quot; certificate and key
[certs] Generating &quot;etcd/ca&quot; certificate and key
[certs] Generating &quot;etcd/server&quot; certificate and key
[certs] etcd/server serving cert is signed for DNS names [k8s-master-1 localhost] and IPs [192.168.0.127 127.0.0.1 ::1]
[certs] Generating &quot;etcd/peer&quot; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [k8s-master-1 localhost] and IPs [192.168.0.127 127.0.0.1 ::1]
[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key
[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key
[certs] Generating &quot;ca&quot; certificate and key
[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [k8s-master-1 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.0.127]
[certs] Generating &quot;sa&quot; key and public key
[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;
[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;kubelet.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file
[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;
[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;
[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;
[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;
[etcd] Creating static Pod manifest for local etcd in &quot;/etc/kubernetes/manifests&quot;
[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;/etc/kubernetes/manifests&quot;. This can take up to 4m0s
[apiclient] All control plane components are healthy after 19.001686 seconds
[uploadconfig] storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace
[kubelet] Creating a ConfigMap &quot;kubelet-config-1.13&quot; in namespace kube-system with the configuration for the kubelets in the cluster
[patchnode] Uploading the CRI Socket information &quot;/var/run/dockershim.sock&quot; to the Node API object &quot;k8s-master-1&quot; as an annotation
[mark-control-plane] Marking the node k8s-master-1 as control-plane by adding the label &quot;node-role.kubernetes.io/master=''&quot;
[mark-control-plane] Marking the node k8s-master-1 as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]
[bootstrap-token] Using token: 8tpo9l.jlw135r8559kaad4
[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles
[bootstraptoken] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials
[bootstraptoken] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
[bootstraptoken] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster
[bootstraptoken] creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace
[addons] Applied essential addon: CoreDNS
[addons] Applied essential addon: kube-proxy

Your Kubernetes master has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

You should now deploy a pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

You can now join any number of machines by running the following on each node
as root:

  kubeadm join 192.168.0.127:6443 --token 8tpo9l.jlw135r8559kaad4 --discovery-token-ca-cert-hash sha256:d6594ccc1310a45cbebc45f1c93f5ac113873786365ed63efcf667c952d7d197
</code></pre></div><ul><li>ç»™ master æœºå­è®¾ç½®é…ç½®</li></ul> <div class="language- extra-class"><pre class="language-text"><code>mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
export KUBECONFIG=$HOME/.kube/config
</code></pre></div><ul><li>åœ¨ master ä¸ŠæŸ¥çœ‹ä¸€äº›ç¯å¢ƒ</li></ul> <div class="language- extra-class"><pre class="language-text"><code>kubeadm token list

kubectl cluster-info
</code></pre></div><ul><li>ç»™ master å®‰è£… Flannel</li></ul> <div class="language- extra-class"><pre class="language-text"><code>cd /opt &amp;&amp; wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml

kubectl apply -f /opt/kube-flannel.yml
</code></pre></div><ul><li>åˆ° node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼š</li></ul> <div class="language- extra-class"><pre class="language-text"><code>echo 1 &gt; /proc/sys/net/bridge/bridge-nf-call-iptables

kubeadm join 192.168.0.127:6443 --token 8tpo9l.jlw135r8559kaad4 --discovery-token-ca-cert-hash sha256:d6594ccc1310a45cbebc45f1c93f5ac113873786365ed63efcf667c952d7d197

è¿™æ—¶å€™ç»ˆç«¯ä¼šè¾“å‡ºï¼š

[preflight] Running pre-flight checks
[discovery] Trying to connect to API Server &quot;192.168.0.127:6443&quot;
[discovery] Created cluster-info discovery client, requesting info from &quot;https://192.168.0.127:6443&quot;
[discovery] Requesting info from &quot;https://192.168.0.127:6443&quot; again to validate TLS against the pinned public key
[discovery] Cluster info signature and contents are valid and TLS certificate validates against pinned roots, will use API Server &quot;192.168.0.127:6443&quot;
[discovery] Successfully established connection with API Server &quot;192.168.0.127:6443&quot;
[join] Reading configuration from the cluster...
[join] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -oyaml'
[kubelet] Downloading configuration for the kubelet from the &quot;kubelet-config-1.13&quot; ConfigMap in the kube-system namespace
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Activating the kubelet service
[tlsbootstrap] Waiting for the kubelet to perform the TLS Bootstrap...
[patchnode] Uploading the CRI Socket information &quot;/var/run/dockershim.sock&quot; to the Node API object &quot;k8s-node-1&quot; as an annotation

This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run 'kubectl get nodes' on the master to see this node join the cluster.
</code></pre></div><ul><li>å¦‚æœ node èŠ‚ç‚¹åŠ å…¥å¤±è´¥ï¼Œå¯ä»¥ï¼š<code>kubeadm reset</code>ï¼Œå†æ¥é‡æ–° join</li> <li>åœ¨ master èŠ‚ç‚¹ä¸Šï¼š<code>kubectl get cs</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>NAME                 STATUS    MESSAGE              ERROR
controller-manager   Healthy   ok
scheduler            Healthy   ok
etcd-0               Healthy   {&quot;health&quot;: &quot;true&quot;} 
ç»“æœéƒ½æ˜¯ Healthy åˆ™è¡¨ç¤ºå¯ä»¥äº†ï¼Œä¸ç„¶å°±å¾—æ£€æŸ¥ã€‚å¿…è¦æ—¶å¯ä»¥ç”¨ï¼š`kubeadm reset` é‡ç½®ï¼Œé‡æ–°è¿›è¡Œé›†ç¾¤åˆå§‹åŒ–
</code></pre></div><ul><li>åœ¨ master èŠ‚ç‚¹ä¸Šï¼š<code>kubectl get nodes</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>å¦‚æœè¿˜æ˜¯ NotReadyï¼Œåˆ™æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼škubectl get pods --all-namespaces
å…¶ä¸­ï¼šPending/ContainerCreating/ImagePullBackOff éƒ½æ˜¯ Pod æ²¡æœ‰å°±ç»ªï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æŸ¥çœ‹å¯¹åº” Pod é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜
kubectl describe pod &lt;Pod Name&gt; --namespace=kube-system
æˆ–è€…ï¼škubectl logs &lt;Pod Name&gt; -n kube-system
tail -f /var/log/messages
</code></pre></div><h4 id="ä¸»è¦æ¦‚å¿µ"><a href="#ä¸»è¦æ¦‚å¿µ" class="header-anchor">#</a> ä¸»è¦æ¦‚å¿µ</h4> <ul><li><p>Master èŠ‚ç‚¹ï¼Œè´Ÿè´£é›†ç¾¤çš„è°ƒåº¦ã€é›†ç¾¤çš„ç®¡ç†</p> <ul><li>å¸¸è§ç»„ä»¶ï¼š<a href="https://kubernetes.io/docs/concepts/overview/components/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/overview/components/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>kube-apiserverï¼šAPIæœåŠ¡</li> <li>kube-schedulerï¼šè°ƒåº¦</li> <li>Kube-Controller-Managerï¼šå®¹å™¨ç¼–æ’</li> <li>Etcdï¼šä¿å­˜äº†æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€</li> <li>Kube-proxyï¼šè´Ÿè´£ä¸º Service æä¾› cluster å†…éƒ¨çš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡</li> <li>Kube-DNSï¼šè´Ÿè´£ä¸ºæ•´ä¸ªé›†ç¾¤æä¾› DNS æœåŠ¡</li></ul></li> <li><p>node èŠ‚ç‚¹ï¼Œè´Ÿè´£å®¹å™¨ç›¸å…³çš„å¤„ç†</p></li> <li><p><code>Pods</code></p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>åˆ›å»ºï¼Œè°ƒåº¦ä»¥åŠç®¡ç†çš„æœ€å°å•å…ƒ
å…±å­˜çš„ä¸€ç»„å®¹å™¨çš„é›†åˆ
å®¹å™¨å…±äº«PIDï¼Œç½‘ç»œï¼ŒIPCä»¥åŠUTSå‘½åç©ºé—´
å®¹å™¨å…±äº«å­˜å‚¨å·
çŸ­æš‚å­˜åœ¨
</code></pre></div><ul><li><code>Volumes</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>æ•°æ®æŒä¹…åŒ–
Podä¸­å®¹å™¨å…±äº«æ•°æ®
ç”Ÿå‘½å‘¨æœŸ
æ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®å· â€“ emptyDir, hostpath, gcePersistentDisk, awsElasticBlockStore, nfs, iscsi, glusterfs, secrets
</code></pre></div><ul><li><code>Labels</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>ç”¨ä»¥æ ‡ç¤ºå¯¹è±¡ï¼ˆå¦‚Podï¼‰çš„key/valueå¯¹
ç»„ç»‡å¹¶é€‰æ‹©å¯¹è±¡å­é›†
</code></pre></div><ul><li><code>Replication Controllers</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>ç¡®ä¿åœ¨ä»»ä¸€æ—¶åˆ»è¿è¡ŒæŒ‡å®šæ•°ç›®çš„Pod
å®¹å™¨é‡æ–°è°ƒåº¦
è§„æ¨¡è°ƒæ•´
åœ¨çº¿å‡çº§
å¤šå‘å¸ƒç‰ˆæœ¬è·Ÿè¸ª
</code></pre></div><ul><li><code>Services</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>æŠ½è±¡ä¸€ç³»åˆ—Podå¹¶å®šä¹‰å…¶è®¿é—®è§„åˆ™
å›ºå®šIPåœ°å€å’ŒDNSåŸŸå
é€šè¿‡ç¯å¢ƒå˜é‡å’ŒDNSå‘ç°æœåŠ¡
è´Ÿè½½å‡è¡¡
å¤–éƒ¨æœåŠ¡ â€“ ClusterIP, NodePort, LoadBalancer
</code></pre></div><h4 id="ä¸»è¦ç»„æˆæ¨¡å—"><a href="#ä¸»è¦ç»„æˆæ¨¡å—" class="header-anchor">#</a> ä¸»è¦ç»„æˆæ¨¡å—</h4> <ul><li><code>etcd</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>é«˜å¯ç”¨çš„Key/Valueå­˜å‚¨
åªæœ‰apiserveræœ‰è¯»å†™æƒé™
ä½¿ç”¨etcdé›†ç¾¤ç¡®ä¿æ•°æ®å¯é æ€§
</code></pre></div><ul><li><code>apiserver</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>Kubernetesç³»ç»Ÿå…¥å£ï¼Œ REST
è®¤è¯
æˆæƒ
è®¿é—®æ§åˆ¶
æœåŠ¡å¸å·
èµ„æºé™åˆ¶
</code></pre></div><ul><li><code>kube-scheduler</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>èµ„æºéœ€æ±‚
æœåŠ¡éœ€æ±‚
ç¡¬ä»¶/è½¯ä»¶/ç­–ç•¥é™åˆ¶
å…³è”æ€§å’Œéå…³è”æ€§
æ•°æ®æœ¬åœ°åŒ–
</code></pre></div><ul><li><code>kube-controller-manager</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>Replication controller
Endpoint controller
Namespace controller
Serviceaccount controller
</code></pre></div><ul><li><code>kubelet</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>èŠ‚ç‚¹ç®¡ç†å™¨
ç¡®ä¿è°ƒåº¦åˆ°æœ¬èŠ‚ç‚¹çš„Podçš„è¿è¡Œå’Œå¥åº·
</code></pre></div><ul><li><code>kube-proxy</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>Podç½‘ç»œä»£ç†
TCP/UDPè¯·æ±‚è½¬å‘
è´Ÿè½½å‡è¡¡ï¼ˆRound Robinï¼‰
</code></pre></div><ul><li><code>æœåŠ¡å‘ç°</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>ç¯å¢ƒå˜é‡
DNS â€“ kube2skyï¼Œ etcdï¼Œskydns
</code></pre></div><ul><li><code>ç½‘ç»œ</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>å®¹å™¨é—´äº’ç›¸é€šä¿¡
èŠ‚ç‚¹å’Œå®¹å™¨é—´äº’ç›¸é€šä¿¡
æ¯ä¸ªPodä½¿ç”¨ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„IP
</code></pre></div><ul><li><code>é«˜å¯ç”¨</code></li></ul> <div class="language- extra-class"><pre class="language-text"><code>kubeletä¿è¯æ¯ä¸€ä¸ªmasterèŠ‚ç‚¹çš„æœåŠ¡æ­£å¸¸è¿è¡Œ
ç³»ç»Ÿç›‘æ§ç¨‹åºç¡®ä¿kubeletæ­£å¸¸è¿è¡Œ
Etcdé›†ç¾¤
å¤šä¸ªapiserverè¿›è¡Œè´Ÿè½½å‡è¡¡
Masteré€‰ä¸¾ç¡®ä¿kube-schedulerå’Œkube-controller-manageré«˜å¯ç”¨
</code></pre></div><h2 id="èµ„æ–™"><a href="#èµ„æ–™" class="header-anchor">#</a> èµ„æ–™</h2> <ul><li><a href="https://juejin.im/entry/5a03f98d6fb9a04524054516" target="_blank" rel="noopener noreferrer">å¦‚ä½•æ›´â€œä¼˜é›…â€åœ°éƒ¨ç½²Kubernetesé›†ç¾¤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href=""></a></li> <li><a href=""></a></li> <li><a href=""></a></li> <li><a href=""></a></li> <li><a href=""></a></li> <li><a href=""></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/adminlove520/Linux_All_in_one/edit/main/docs/docker/K8S-Install-And-Usage.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">3 hours ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Linux_All_in_one/assets/js/app.4a61619a.js" defer></script><script src="/Linux_All_in_one/assets/js/2.ee3c5eb7.js" defer></script><script src="/Linux_All_in_one/assets/js/1.bc260717.js" defer></script><script src="/Linux_All_in_one/assets/js/36.da0b8594.js" defer></script><script src="/Linux_All_in_one/assets/js/21.f8578145.js" defer></script>
  </body>
</html>
